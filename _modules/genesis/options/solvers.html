

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>genesis.options.solvers &#8212; Genesis 0.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.4cbf315f70debaebd550c87a6162cf0f.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/genesis/options/solvers';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.4';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = '_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'v0.1.0';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../../../_static/genesis_logo_small.svg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/genesis_logo_small.svg" class="logo__image only-light" alt="Genesis 0.1.0 documentation - Home"/>
    <script>document.write(`<img src="../../../_static/logo_white.svg" class="logo__image only-dark" alt="Genesis 0.1.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../api_reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../roadmap/index.html">
    Roadmap
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/haosulab/ManiSkill" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://maniskill.ai" title="Website" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-globe fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Website</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-3"
      type="button"
      class="version-switcher__button btn btn-sm dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-3"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-3"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-3">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
          
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../api_reference/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../roadmap/index.html">
    Roadmap
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/haosulab/ManiSkill" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://maniskill.ai" title="Website" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-globe fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Website</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">genesis.opti...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for genesis.options.solvers</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">genesis</span> <span class="k">as</span> <span class="nn">gs</span>

<span class="kn">from</span> <span class="nn">.options</span> <span class="kn">import</span> <span class="n">Options</span>

<span class="c1">############################ Top level: simulator and coupler ############################</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Simulator options specifies the global settings for the simulator and the coupler options specifies whether the coupling between pairs of solvers is enabled.</span>
<span class="sd">&#39;&#39;&#39;</span>

<div class="viewcode-block" id="SimOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/sim_options.html#genesis.options.solvers.SimOptions">[docs]</a><span class="k">class</span> <span class="nc">SimOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the top-level simulator.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    1. `SimOptions` specifies the global settings for the simulator. Some parameters exist both in `SimOptions` and `SolverOptions`. In this case, if such parameters are given in `SolverOptions`, it will override the one specified in `SimOptions` for this specific solver. For example, if `dt` is only given in `SimOptions`, it will be shared by all the solvers, but it&#39;s also possible to let a solver run at a different temporal speed by setting its own `dt` to be a different value.</span>

<span class="sd">    2. In differentiable mode, `substeps_local` must be divisible by `substeps`, as external command is input per `step`, but `substep`. If `requires_grad` is False, we can use arbitrary `substeps_local`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. Defaults to 1e-2.</span>
<span class="sd">    substeps : int, optional</span>
<span class="sd">        Number of substeps per simulation step. Defaults to 1.</span>
<span class="sd">    substeps_local : int, optional</span>
<span class="sd">        Number of substeps stored in GPU memory. Defaults to None. This is used for differentiable mode.</span>
<span class="sd">    gravity : tuple, optional</span>
<span class="sd">        Gravity force in N/kg. Defaults to (0.0, 0.0, -9.81).</span>
<span class="sd">    floor_height : float, optional</span>
<span class="sd">        Height of the floor in meters. Defaults to 0.0.</span>
<span class="sd">    requires_grad : bool, optional</span>
<span class="sd">        Whether to enable differentiable mode. Defaults to False.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dt</span>             <span class="p">:</span> <span class="nb">float</span>         <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">substeps</span>       <span class="p">:</span> <span class="nb">int</span>           <span class="o">=</span> <span class="mi">1</span>
    <span class="n">substeps_local</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># number of substeps stored in GPU memory</span>
    <span class="n">gravity</span>        <span class="p">:</span> <span class="nb">tuple</span>         <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.81</span><span class="p">)</span>
    <span class="n">floor_height</span>   <span class="p">:</span> <span class="nb">float</span>         <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">requires_grad</span>  <span class="p">:</span> <span class="nb">bool</span>          <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># not set by user</span>
    <span class="n">_steps_local</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">substeps_local</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substeps_local</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substeps</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># use 1 to save gpu memory</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substeps_local</span> <span class="o">=</span> <span class="mi">1</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">substeps_local</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">substeps</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="s1">&#39;`substeps_local` must be divisible by `substeps` when `requires_grad` is True.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_steps_local</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substeps_local</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">substeps</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_steps_local</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="CouplerOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/coupler_options.html#genesis.options.solvers.CouplerOptions">[docs]</a><span class="k">class</span> <span class="nc">CouplerOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the inter-solver coupling.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rigid_mpm : bool, optional</span>
<span class="sd">        Whether to enable coupling between rigid and MPM solvers. Defaults to True.</span>
<span class="sd">    rigid_sph : bool, optional</span>
<span class="sd">        Whether to enable coupling between rigid and SPH solvers. Defaults to True.</span>
<span class="sd">    rigid_pbd : bool, optional</span>
<span class="sd">        Whether to enable coupling between rigid and PBD solvers. Defaults to True.</span>
<span class="sd">    rigid_fem : bool, optional</span>
<span class="sd">        Whether to enable coupling between rigid and FEM solvers. Defaults to True.</span>
<span class="sd">    mpm_sph : bool, optional</span>
<span class="sd">        Whether to enable coupling between MPM and SPH solvers. Defaults to True.</span>
<span class="sd">    mpm_pbd : bool, optional</span>
<span class="sd">        Whether to enable coupling between MPM and PBD solvers. Defaults to True.</span>
<span class="sd">    fem_mpm : bool, optional</span>
<span class="sd">        Whether to enable coupling between FEM and MPM solvers. Defaults to True.</span>
<span class="sd">    fem_sph : bool, optional</span>
<span class="sd">        Whether to enable coupling between FEM and SPH solvers. Defaults to True.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">rigid_mpm</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">rigid_sph</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">rigid_pbd</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">rigid_fem</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">mpm_sph</span>   <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">mpm_pbd</span>   <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fem_mpm</span>   <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">fem_sph</span>   <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></div>


<span class="c1">############################ Solvers inside simulator ############################</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Parameters in these solver-specific options will override SimOptions if available.</span>
<span class="sd">&#39;&#39;&#39;</span>

<div class="viewcode-block" id="ToolOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/tool_options.html#genesis.options.solvers.ToolOptions">[docs]</a><span class="k">class</span> <span class="nc">ToolOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the ToolSolver. </span>
<span class="sd">    </span>
<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    ToolEntity is a simplified form of RigidEntity. It supports one way tool-&gt;other coupling, but has *no* internal dynamics and can only be created from a single mesh. This is a temporal workaround for differentiable rigid-soft interaction. This solver will be removed once differentiable mode is supported by the RigidSolver.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. Defaults to 1e-2.</span>
<span class="sd">    floor_height : float, optional</span>
<span class="sd">        Height of the floor in meters. Defaults to 0.0.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dt</span>           <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">floor_height</span> <span class="p">:</span> <span class="nb">float</span>           <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="RigidOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/rigid_options.html#genesis.options.solvers.RigidOptions">[docs]</a><span class="k">class</span> <span class="nc">RigidOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the RigidSolver.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    gravity : tuple, optional</span>
<span class="sd">        Gravity force in N/kg. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    enable_collision : bool, optional</span>
<span class="sd">        Whether to enable collision detection. Defaults to True.</span>
<span class="sd">    enable_joint_limit : bool, optional</span>
<span class="sd">        Whether to enable joint limit. Defaults to True.</span>
<span class="sd">    enable_self_collision : bool, optional</span>
<span class="sd">        Whether to enable self collision within each entity. Defaults to False.</span>
<span class="sd">    max_collision_pairs : int, optional</span>
<span class="sd">        Maximum number of collision pairs. Defaults to 100.</span>
<span class="sd">    integrator : gs.integrator, optional</span>
<span class="sd">        Integrator type. Current supported integrators are &#39;gs.integrator.implicitfast&#39; and &#39;gs.integrator.explicit&#39;. Defaults to &#39;implicitfast&#39;.</span>
<span class="sd">    IK_max_targets : int, optional</span>
<span class="sd">        Maximum number of IK targets. Increasing this doesn&#39;t affect IK solving speed, but will increase memory usage. Defaults to 6.</span>
<span class="sd">    constraint_solver : gs.constraint_solver, optional</span>
<span class="sd">        Constraint solver type. Current supported constraint solvers are &#39;gs.constraint_solver.CG&#39; and &#39;gs.constraint_solver.Newton&#39;. Defaults to &#39;CG&#39;.</span>
<span class="sd">    iterations : int, optional</span>
<span class="sd">        Number of iterations for the constraint solver. Defaults to 100.</span>
<span class="sd">    tolerance : float, optional</span>
<span class="sd">        Tolerance for the constraint solver. Defaults to 1e-5.</span>
<span class="sd">    ls_iterations : int, optional</span>
<span class="sd">        Number of line search iterations for the constraint solver. Defaults to 50.</span>
<span class="sd">    ls_tolerance : float, optional</span>
<span class="sd">        Tolerance for the line search. Defaults to 1e-2.</span>
<span class="sd">    sparse_solve : bool, optional</span>
<span class="sd">        Whether to exploit sparsity in the constraint system. Defaults to False.</span>
<span class="sd">    timeconst : float, optional</span>
<span class="sd">        The smaller the value, the more stiff the constraint. Defaults to 0.02. (https://mujoco.readthedocs.io/en/latest/modeling.html#solver-parameters)</span>
<span class="sd">    use_hibernation : bool, optional</span>
<span class="sd">        Whether to enable hibernation. Defaults to False.</span>
<span class="sd">    hibernation_thresh_vel : float, optional</span>
<span class="sd">        Velocity threshold for hibernation. Defaults to 1e-3.</span>
<span class="sd">    hibernation_thresh_acc : float, optional</span>
<span class="sd">        Acceleration threshold for hibernation. Defaults to 1e-2.</span>

<span class="sd">    Warning</span>
<span class="sd">    -------</span>
<span class="sd">    Hibernation hasn&#39;t been robustly tested and will be fully supported soon.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">dt</span>                    <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gravity</span>               <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">enable_collision</span>      <span class="p">:</span> <span class="nb">bool</span>            <span class="o">=</span> <span class="kc">True</span>
    <span class="n">enable_joint_limit</span>    <span class="p">:</span> <span class="nb">bool</span>            <span class="o">=</span> <span class="kc">True</span>
    <span class="n">enable_self_collision</span> <span class="p">:</span> <span class="nb">bool</span>            <span class="o">=</span> <span class="kc">False</span>
    <span class="n">max_collision_pairs</span>   <span class="p">:</span> <span class="nb">int</span>             <span class="o">=</span> <span class="mi">100</span>
    <span class="n">integrator</span>            <span class="p">:</span> <span class="n">gs</span><span class="o">.</span><span class="n">integrator</span>   <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">integrator</span><span class="o">.</span><span class="n">implicitfast</span>
    <span class="n">IK_max_targets</span>        <span class="p">:</span> <span class="nb">int</span>             <span class="o">=</span> <span class="mi">6</span> 

    <span class="c1"># constraint solver</span>
    <span class="n">constraint_solver</span> <span class="p">:</span> <span class="n">gs</span><span class="o">.</span><span class="n">constraint_solver</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">constraint_solver</span><span class="o">.</span><span class="n">CG</span>
    <span class="n">iterations</span>        <span class="p">:</span> <span class="nb">int</span>                  <span class="o">=</span> <span class="mi">100</span>
    <span class="n">tolerance</span>         <span class="p">:</span> <span class="nb">float</span>                <span class="o">=</span> <span class="mf">1e-5</span>
    <span class="n">ls_iterations</span>     <span class="p">:</span> <span class="nb">int</span>                  <span class="o">=</span> <span class="mi">50</span>
    <span class="n">ls_tolerance</span>      <span class="p">:</span> <span class="nb">float</span>                <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="n">sparse_solve</span>      <span class="p">:</span> <span class="nb">bool</span>                 <span class="o">=</span> <span class="kc">False</span>
    <span class="n">timeconst</span>         <span class="p">:</span> <span class="nb">float</span>                <span class="o">=</span> <span class="mf">0.02</span>

    <span class="c1"># hibernation threshold</span>
    <span class="n">use_hibernation</span>        <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span>
    <span class="n">hibernation_thresh_vel</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
    <span class="n">hibernation_thresh_acc</span> <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-2</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="AvatarOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/avatar_options.html#genesis.options.solvers.AvatarOptions">[docs]</a><span class="k">class</span> <span class="nc">AvatarOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the AvatarSolver. AvatarEntity is similar to RigidEntity, but without internal physics.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    enable_collision : float, optional</span>
<span class="sd">        Whether to enable collision detection. Defaults to False.</span>
<span class="sd">    enable_self_collision : float, optional</span>
<span class="sd">        Whether to enable self collision within each entity. Defaults to False.</span>
<span class="sd">    max_collision_pairs : int, optional</span>
<span class="sd">        Maximum number of collision pairs. Defaults to 100.</span>
<span class="sd">    IK_max_targets : int, optional</span>
<span class="sd">        Maximum number of IK targets. Increasing this doesn&#39;t affect IK solving speed, but will increase memory usage. Defaults to 6.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dt</span>                    <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">enable_collision</span>      <span class="p">:</span> <span class="nb">bool</span>            <span class="o">=</span> <span class="kc">False</span>
    <span class="n">enable_self_collision</span> <span class="p">:</span> <span class="nb">bool</span>            <span class="o">=</span> <span class="kc">False</span>
    <span class="n">max_collision_pairs</span>   <span class="p">:</span> <span class="nb">int</span>             <span class="o">=</span> <span class="mi">100</span>
    <span class="n">IK_max_targets</span>        <span class="p">:</span> <span class="nb">int</span>             <span class="o">=</span> <span class="mi">6</span> <span class="c1"># Increasing this doesn&#39;t affect IK solving speed, but will increase memory usage</span></div>

<div class="viewcode-block" id="MPMOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/mpm_options.html#genesis.options.solvers.MPMOptions">[docs]</a><span class="k">class</span> <span class="nc">MPMOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the MPMSolver.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    MPM is a hybrid lagrangian-eulerian method for simulating soft materials. In the eulerian phase, it uses a grid representation. The `upper_bound` and `lower_bound` specify the simulation domain, but a safety padding will be added to the actual grid boundary. Therefore, the actual boundary could be slightly tighter than the specified one. Note that the size of the domain affects the performance of the simulation, hence you should set it as tight as possible.</span>

<span class="sd">    `use_sparse_grid` and `leaf_block_size` are advanced parameters for sparse computation. Don&#39;t touch them unless you know what you are doing.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    gravity : tuple, optional</span>
<span class="sd">        Gravity force in N/kg. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    particle_size : float, optional</span>
<span class="sd">        Particle diameter in meters. If not given, we will compute `particle_size` based on `grid_density`, where `particle_size` will be linearly proportional to the grid cell size. A reference value is `particle_size = 0.01` for `grid_density = 64`. Defaults to None.</span>
<span class="sd">    grid_density : float, optional</span>
<span class="sd">        Number of grid cells per meter. Defaults to 64.</span>
<span class="sd">    enable_CPIC : bool, optional</span>
<span class="sd">        Whether to enable CPIC (Compatible Particle-in-Cell) to support coupling with thin objects. Defaults to False.</span>
<span class="sd">    lower_bound : tuple, shape (3,), optional</span>
<span class="sd">        Lower bound of the simulation domain. Defaults to (-1.0, -1.0, 0.0).</span>
<span class="sd">    upper_bound : tuple, shape (3,), optional</span>
<span class="sd">        Upper bound of the simulation domain. Defaults to (1.0, 1.0, 1.0).</span>
<span class="sd">    use_sparse_grid : bool, optional</span>
<span class="sd">        Whether to use sparse grid. Defaults to False. Don&#39;t touch unless you know what you are doing.</span>
<span class="sd">    leaf_block_size : int, optional</span>
<span class="sd">        Size of the leaf block for sparse mode. Defaults to 8.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">dt</span>            <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gravity</span>       <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">particle_size</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>   <span class="c1"># in meters. Will be computed automatically if it&#39;s None.</span>
    <span class="n">grid_density</span>  <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">64</span>
    <span class="n">enable_CPIC</span>   <span class="p">:</span> <span class="nb">bool</span>  <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># These will later be converted to discrete grid bound. The actual grid boundary could be slightly tighter.</span>
    <span class="n">lower_bound</span> <span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Sparse computation parameter. Don&#39;t touch unless you know what you are doing.</span>
    <span class="n">use_sparse_grid</span> <span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">leaf_block_size</span> <span class="p">:</span> <span class="nb">int</span>  <span class="o">=</span> <span class="mi">8</span> <span class="c1"># NOTE: taichi_elements uses 4, which in our case will hang and crash. Probably due to some memory access issue.</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">)):</span>
            <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="s1">&#39;Invalid pair of upper_bound and lower_bound.&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">particle_size</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="mf">64.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_density</span></div>

<div class="viewcode-block" id="SPHOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/sph_options.html#genesis.options.solvers.SPHOptions">[docs]</a><span class="k">class</span> <span class="nc">SPHOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the SPHSolver.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If spatial hashing parameters are not given, we will compute them automatically this way: For `hash_grid_cell_size`, we will set it to be the `support_radius`, which is essentially 2 * `particle_size`. For `hash_grid_res`, if a small bound is given, it&#39;s used for the hash grid; otherwise, we use a default value of a 150^3 cube. Any grid bigger than that will results in too many cells hence not ideal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    gravity : tuple, optional</span>
<span class="sd">        Gravity force in N/kg. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    particle_size : float, optional</span>
<span class="sd">        Particle diameter in meters. Defaults to 0.02.</span>
<span class="sd">    pressure_solver : str, optional</span>
<span class="sd">        Pressure solver type. Current supported pressure solvers are &#39;WCSPH&#39; and &#39;DFSPH&#39;. Defaults to &#39;WCSPH&#39;.</span>
<span class="sd">    lower_bound : tuple, shape (3,), optional</span>
<span class="sd">        Lower bound of the simulation domain. Defaults to (-100.0, -100.0, 0.0).</span>
<span class="sd">    upper_bound : tuple, shape (3,), optional</span>
<span class="sd">        Upper bound of the simulation domain. Defaults to (100.0, 100.0, 100.0).</span>
<span class="sd">    hash_grid_res : tuple, optional</span>
<span class="sd">        Size of the spatially-repetitive spatial hashing grid in meters. If none, it will be computed automatically. Defaults to None.</span>
<span class="sd">    hash_grid_cell_size : float, optional</span>
<span class="sd">        Size of the lattic cell of the spatial hashing grid in meters. This should be at least 2 * `particle_size`. If none, it will be computed automatically. Defaults to None.</span>
<span class="sd">    max_divergence_error : float, optional</span>
<span class="sd">        Maximum divergence error for DFSPH. Defaults to 0.1.</span>
<span class="sd">    max_density_error_percent : float, optional</span>
<span class="sd">        Maximum density error *percent* for DFSPH, so 0.1 means 0.1%. Defaults to 0.05.</span>
<span class="sd">    max_divergence_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the divergence solver. Defaults to 100.</span>
<span class="sd">    max_density_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the density solver. Defaults to 100.</span>
<span class="sd">    &#39;&#39;&#39;</span>
        


    <span class="n">dt</span>              <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gravity</span>         <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">particle_size</span>   <span class="p">:</span> <span class="nb">float</span>           <span class="o">=</span> <span class="mf">0.02</span>
    <span class="n">pressure_solver</span> <span class="p">:</span> <span class="nb">str</span>             <span class="o">=</span> <span class="s1">&#39;WCSPH&#39;</span> <span class="c1"># &#39;WCSPH&#39; or &#39;DFSPH&#39;</span>
    
    <span class="n">lower_bound</span> <span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>

    <span class="c1"># spatial hashing</span>
    <span class="n">hash_grid_res</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># size of the spatially-repetitive hash grid in meters</span>
    <span class="n">hash_grid_cell_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># size of the cubic cell in meters</span>

    <span class="c1"># DFSPH parameters</span>
    <span class="n">max_divergence_error</span>             <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">max_density_error_percent</span>        <span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="c1"># This is percent</span>
    <span class="n">max_divergence_solver_iterations</span> <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">100</span>
    <span class="n">max_density_solver_iterations</span>    <span class="p">:</span> <span class="nb">int</span>   <span class="o">=</span> <span class="mi">100</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">)):</span>
            <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="s1">&#39;Invalid pair of upper_bound and lower_bound.&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_support_radius</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_size</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_support_radius</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_support_radius</span><span class="p">:</span>
                <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="s1">&#39;`hash_grid_cell_size` should not be smaller than 2 * `particle_size`.&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">default_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">max_hash_grid_res</span><span class="p">,</span> <span class="n">default_hash_grid_res</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_res</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        
        <span class="c1"># check pressure solver</span>
        <span class="n">pressure_solver_available</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;WCSPH&#39;</span><span class="p">,</span> <span class="s1">&#39;DFSPH&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pressure_solver</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pressure_solver_available</span><span class="p">:</span>
            <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure solver </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pressure_solver</span><span class="si">}</span><span class="s1"> not implemented. Please select among </span><span class="si">{</span><span class="n">pressure_solver_available</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PBDOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/pbd_options.html#genesis.options.solvers.PBDOptions">[docs]</a><span class="k">class</span> <span class="nc">PBDOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the PBDSolver.</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    If spatial hashing parameters are not given, we will compute them automatically this way: For `hash_grid_cell_size`, we will set it to be 1.25 * `particle_size`. For `hash_grid_res`, if a small bound is given, it&#39;s used for the hash grid; otherwise, we use a default value of a 150^3 cube. Any grid bigger than that will results in too many cells hence not ideal.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    gravity : tuple, optional</span>
<span class="sd">        Gravity force in N/kg. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    max_stretch_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the solving stretch constraints. Defaults to 4.</span>
<span class="sd">    max_bending_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the solving bending constraints. Defaults to 1.</span>
<span class="sd">    max_volume_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the solving volume constraints. Defaults to 1.</span>
<span class="sd">    max_density_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the solving density constraints. Defaults to 1.</span>
<span class="sd">    max_viscosity_solver_iterations : int, optional</span>
<span class="sd">        Maximum number of iterations for the solving viscosity constraints. Defaults to 1.</span>
<span class="sd">    particle_size : float, optional</span>
<span class="sd">        Particle diameter in meters. Defaults to 1e-2.</span>
<span class="sd">    hash_grid_res : tuple, optional</span>
<span class="sd">        Size of the spatially-repetitive spatial hashing grid in meters. If none, it will be computed automatically. Defaults to None.</span>
<span class="sd">    hash_grid_cell_size : float, optional</span>
<span class="sd">        Size of the lattic cell of the spatial hashing grid in meters. This should be at least 1.25 * `particle_size`. If none, it will be computed automatically. Defaults to None.</span>
<span class="sd">    lower_bound : tuple, shape (3,), optional</span>
<span class="sd">        Lower bound of the simulation domain. Defaults to (-100.0, -100.0, 0.0).</span>
<span class="sd">    upper_bound : tuple, shape (3,), optional</span>
<span class="sd">        Upper bound of the simulation domain. Defaults to (100.0, 100.0, 100.0).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">dt</span>      <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gravity</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># constraints solving iterations</span>
    <span class="n">max_stretch_solver_iterations</span>   <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">max_bending_solver_iterations</span>   <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">max_volume_solver_iterations</span>    <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">max_density_solver_iterations</span>   <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">max_viscosity_solver_iterations</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># self collision</span>
    <span class="n">particle_size</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-2</span>

    <span class="c1"># spatial hashing</span>
    <span class="n">hash_grid_res</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># size of the spatially-repetitive hash grid in meters</span>
    <span class="n">hash_grid_cell_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># size of the cubic cell in meters</span>

    <span class="n">lower_bound</span> <span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">upper_bound</span> <span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">)):</span>
            <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="s1">&#39;Invalid pair of upper_bound and lower_bound.&#39;</span><span class="p">)</span>

        <span class="c1"># NOTE: 1.25 is a safety factor, as inside one single substep, multiple substages can change the position of the particles but we only do spatial hashing once.</span>
        <span class="c1"># Therefore, the grid cell needs to be a bit bigger so that neighbours are not missed.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span> <span class="o">=</span> <span class="mf">1.25</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_size</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span> <span class="o">&lt;</span> <span class="mf">1.25</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">particle_size</span><span class="p">:</span>
                <span class="n">gs</span><span class="o">.</span><span class="n">raise_exception</span><span class="p">(</span><span class="s1">&#39;`hash_grid_cell_size` should not be smaller than 1.25 * `particle_size`.&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># compute _hash_grid_res smartly</span>
            <span class="c1"># if a small bound is given, it&#39;s used for the hash grid</span>
            <span class="c1"># Otherwise, we use a default value of a 150^3 cube. Any grid bigger than that will results in too many cells hence not ideal.</span>
            <span class="n">max_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">default_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">150</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">max_hash_grid_res</span><span class="p">,</span> <span class="n">default_hash_grid_res</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hash_grid_res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_res</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">hash_grid_cell_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></div>
        

<div class="viewcode-block" id="FEMOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/fem_options.html#genesis.options.solvers.FEMOptions">[docs]</a><span class="k">class</span> <span class="nc">FEMOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the FEMSolver.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    gravity : tuple, optional</span>
<span class="sd">        Gravity force in N/kg. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    damping : float, optional</span>
<span class="sd">        Damping factor. Defaults to 45.0.</span>
<span class="sd">    floor_height : float, optional</span>
<span class="sd">        Height of the floor in meters. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dt</span>           <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">gravity</span>      <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">damping</span>      <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="mf">45.0</span>
    <span class="n">floor_height</span> <span class="p">:</span> <span class="nb">float</span>           <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="SFOptions"><a class="viewcode-back" href="../../../api_reference/options/simulator_coupler_and_solver_options/sf_options.html#genesis.options.solvers.SFOptions">[docs]</a><span class="k">class</span> <span class="nc">SFOptions</span><span class="p">(</span><span class="n">Options</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Options configuring the SFSolver.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dt : float, optional</span>
<span class="sd">        Time duration for each simulation step in seconds. If none, it will inherit from `SimOptions`. Defaults to None.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">dt</span> <span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>
</pre></div>

                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Genesis Developers.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.2.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>